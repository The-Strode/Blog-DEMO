<%- include("partials/header.ejs") %>

<%- include("partials/post-form.ejs") %>

    <!-- For-loop to display blog posts dynamically -->

    <div class="blog-posts">
        <div class="section-title">
            <h2>All Posts</h2>
        </div>

        <!-- If-else statement determines if there are any posts to display. If not, a message is displayed instead -->

        <% if (locals.posts && locals.posts.length > 0 && locals.texts && locals.texts.length > 0) { %>

            <% for(i=0; i < posts.length; i++) { %>
                <li>
                    <h2>
                        <%= posts[i] %>
                    </h2>
                    <h4>
                        <%= timestamps[i] %>
                    </h4>
                    <p>
                        <%= texts[i] %>
                    </p>
                    <div class="post-controls">
                        <form action="/edit" method="GET">
                            <input type="hidden" name="postIndex" value="<%= i %>">
                            <input type="submit" value="Edit Post" id="editPost<%= i %>">
                        </form>
                        <form action="/delete" method="POST">
                            <input type="hidden" name="postIndex" value="<%= i %>">
                            <input type="submit" value="Delete Post" id="deletePost<%= i %>">
                        </form>
                    </div>
                </li>
            <% }; %>

        <% } else { %>

        <div>
            <h2>No Posts Available</h2>
            <p>It seems there are no posts yet. Why not create one?</p>
        </div>

        <% }; %>
        
    </div>

<%- include("partials/footer.ejs") %>

<!-- At some point consider moving the posting mechanism and the post rolls into their own partials/pages -->
<!-- This will help isolate the function to call for users local time to only instances that use the post form -->